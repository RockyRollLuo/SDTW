/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.65
 * Generated at: 2017-04-08 02:47:44 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.volunteer;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.xietong.software.sdtw.db.VolunteerProjectParticipate;
import java.util.*;
import java.sql.*;
import com.xietong.software.sdtw.db.BaseUserCode;
import com.xietong.software.common.UserInfo;
import com.xietong.software.util.Tool;
import com.xietong.software.util.*;
import com.xietong.software.common.*;
import com.xietong.software.sdtw.db.*;

public final class volunteer_002dproject_002dparticipate_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/volunteer/pagetop-positionandhelp.jsp", Long.valueOf(1489367536655L));
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

UserInfo userinfo=Tool.getUserInfo(request);
if(userinfo==null){
	return;
}
List cdt1 = new ArrayList();
cdt1.add("roles=3");
List UserCnNameoptions= COptionConst.getUserNameOptions(userinfo, "请选择",cdt1);
List AssLeveloptions=CEditConst.getAssLevelOptions(userinfo);
BaseUserCode user=userinfo.getUserCode();
String sno=user.getName();
String projectId=ParamUtils.getParameter(request, "ProjectId", "");
String projectname="",teamcode="",teamname="",teamunit="",registerid="",setuptime="",zipcode="",contactaddress="",insepctionconclution="";
String asslevel="",starttime="",projectarea="",implearea="",award="",majorid="",guideteacherid="",teammemberslist="";
String majorvolslist="",content="",meanings="",disiredresults="",impleplace="",promotion="",specialist="",beneficaiaries="",checkcomments="";
String majorname="",majorsex="",majorbirth="",majorduty="",majorpolista="",majorphone="",majorphone2="",majoremail="";
String dutyfree="",guideteachername="",guideteachersex="",guideteacherbirth="",guideteacherduty="",guideteacherpolista="",guideteacherphone="",guideteacherphone2="",guideteacheremail="";
int participatenum=0,fulltimenum=0,majorkind=0,benenum=0,edittype=0;
String addfilelist = "";
String url="VolunteerProjectParticipateAction.jsp?cmd=save1";
String[] labelclass = {"labeloff", "labeloff", "labeloff", "labeloff"};
List list = new ArrayList();
List cdt = new ArrayList();
VolunteerProjectParticipate vpp= new VolunteerProjectParticipate();
cdt.add("projectid="+projectId);
cdt.add("sno='"+sno+"'");
list =vpp.query(cdt);

if(list.size()>0){
	url="VolunteerProjectParticipateAction.jsp?cmd=modify2";
	
	System.out.println("111111111111111111111111");
	vpp=(VolunteerProjectParticipate)list.get(0);
	zipcode=vpp.getZipCode();
	projectname=vpp.getProjectName();
	teamname=vpp.getTeamName();
	teamunit=vpp.getTeamUnit();
	registerid=vpp.getRegisterId();
	setuptime=Tool.stringOfDate(vpp.getSetupTime());
	contactaddress=vpp.getContactAddress();
	insepctionconclution=vpp.getInspectionConclution();
	projectarea=vpp.getProjectArea();award=vpp.getAward();guideteacherid=vpp.getGuideTeacherName();
	content=vpp.getContent();meanings=vpp.getMeanings();disiredresults=vpp.getDisiredResults();
	impleplace=vpp.getImplePlace();promotion=vpp.getPromotion();specialist=vpp.getSpecialist();beneficaiaries=vpp.getBeneFicaiaries();checkcomments=vpp.getCheckComments();
	majorname=vpp.getMajorName();majorsex=vpp.getMajorSex();majorphone=vpp.getMajorPhone();majoremail=vpp.getMajorEmail();
	dutyfree=vpp.getDutyFree();guideteachername=vpp.getGuideTeacherName();guideteacherphone=vpp.getGuideTeacherPhone();guideteacheremail=vpp.getGuiderTeacherEmail();
	participatenum=vpp.getParticipateNum();fulltimenum=vpp.getFulltimeNum();benenum=vpp.getBenenum();
	asslevel=vpp.getAssLevel();starttime=Tool.stringOfDate(vpp.getStartTime());implearea=vpp.getImpleArea();
	majorbirth=vpp.getMajorBirth();majorduty=vpp.getMajorDuty();majorpolista=vpp.getMajorPolista();majorphone2=vpp.getMajorPhone2();
	guideteachersex=vpp.getGuideTeacherSex();guideteacherbirth=vpp.getGuideTeacherBirth();guideteacherduty=vpp.getGuideTeacherDuty();guideteacherpolista=vpp.getGuideTeacherPolista();
	guideteacherphone2=vpp.getGuideTeacherPhone2();meanings=vpp.getMeanings();
}


      out.write('\r');
      out.write('\n');
String cmd = ParamUtils.getParameter(request,"cmd",""); 
      out.write("\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/main/jqueryui.jsp", out, true);
      out.write("\r\n");
      out.write("<link type=\"text/css\" href=\"");
      out.print(HeadConst.apache_url+"/main/" );
      out.write("js/chosen/chosen.css\" rel=\"stylesheet\"/>\r\n");
      out.write("\t\t<script language=\"javascript\" src=\"");
      out.print(HeadConst.apache_url+"/main/" );
      out.write("/js/chosen/chosen.jquery.js\"></script>\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"../css/common-student.css\">\r\n");
      out.write("<script src=\"../main/js/common.js\"></script>\r\n");
      out.write("<script src=\"../js/tablelist.js\"></script>\r\n");
      out.write("<link rel=\"stylesheet\" href=\"../css/jqueryUI/jquery-ui.css\">\r\n");
      out.write("\r\n");
      out.write("<script language=\"JavaScript\" src=\"../main/js/ajaxfileupload.js\"></script>\r\n");
      out.write("<script language=\"JavaScript\"\r\n");
      out.write("\t\t\tsrc=\"");
      out.print(HeadConst.apache_url);
      out.write("/main/js/datepicker/WdatePicker.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("window.onload=function(){ \r\n");
      out.write("\t$(\"#baseinfo\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t$(\"#teaminfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t$(\"#otherinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t$(\"#fileinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t$(\"#base\").attr(\"class\",\"labelon\");\r\n");
      out.write("\t$(\"#team\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t$(\"#other\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t$(\"#file\").attr(\"class\",\"labeloff\");\t\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function uploadOtherAttatch(){//上传其他附件\r\n");
      out.write("\t//debugger;\r\n");
      out.write("\tvar name=document.getElementById('OtherAttach').value;\r\n");
      out.write("    $(\"#load1\")\r\n");
      out.write("    .ajaxStart(function(){\r\n");
      out.write("        $(this).show();\r\n");
      out.write("    })\r\n");
      out.write("    .ajaxComplete(function(){\r\n");
      out.write("        $(this).hide();\r\n");
      out.write("    });\r\n");
      out.write("    $.ajaxFileUpload\r\n");
      out.write("    (\r\n");
      out.write("        {\r\n");
      out.write("            url:'VolunteerProjectParticipateAction.jsp?cmd=otherattach',\r\n");
      out.write("            secureuri:false,\r\n");
      out.write("            fileElementId:'OtherAttach',\r\n");
      out.write("            type:'post',\t\r\n");
      out.write("            dataType: 'json',\r\n");
      out.write("            success: function (data, status)\r\n");
      out.write("            {\r\n");
      out.write("             \t\r\n");
      out.write("                if(typeof(data.error) != 'undefined')\r\n");
      out.write("                {\r\n");
      out.write("                    if(data.error != '')\r\n");
      out.write("                    {                    \r\n");
      out.write("                        alert(data.error);\r\n");
      out.write("                    }else\r\n");
      out.write("                    {\r\n");
      out.write("                    \t\r\n");
      out.write("                    \t// if(document.postForm.AddFileList.value==\"\"){\r\n");
      out.write("                         \tvar be = data.url.indexOf(\"=\");\r\n");
      out.write("                         \tvar en = data.url.lastIndexOf(\"/\");\r\n");
      out.write("                         \tdocument.form1.AddFileList.value = data.ids;\r\n");
      out.write("                         \t\r\n");
      out.write("                        /*  }else{\r\n");
      out.write("                         \tvar be = data.url.indexOf(\"=\");\r\n");
      out.write("                         \tvar en = data.url.lastIndexOf(\"/\");\r\n");
      out.write("                         \tdocument.postForm.AddFileList.value += \",\"+data.ids;\r\n");
      out.write("                         }  */\r\n");
      out.write("                         \r\n");
      out.write("                        var table = document.getElementById('ShowFiles');\r\n");
      out.write("                        var num = table.rows.length;\r\n");
      out.write("                        var row = table.insertRow(num);\r\n");
      out.write("                        var filename = data.url.replace(/.*(\\/|\\\\)/, \"\");\r\n");
      out.write("                        filename = data.name;\r\n");
      out.write("                        \r\n");
      out.write("                        var cell = row.insertCell(0);\r\n");
      out.write("                        ");

                        	if(cmd.equals("update")){
                        
      out.write("\r\n");
      out.write("\t\t                        row.id = data.ids;//修改时以防和之前重名\r\n");
      out.write("\t\t                        cell.innerHTML =  '<img src=\\'");
      out.print(HeadConst.apache_url );
      out.write("/main/images/file1.gif\\'/> '+filename+'&nbsp;&nbsp;&nbsp;&nbsp;<img src=\\'");
      out.print(HeadConst.apache_url );
      out.write("/main/images/delete.gif\\' alt=\\'删除\\' title=\\'删除\\' onclick=\\'deleteUpdateFile(\"'+filename+'\",'+data.ids+');\\' style=\"cursor:point;\"/>';\r\n");
      out.write("                        ");

                        	}else{
                        
      out.write("\r\n");
      out.write("\t\t                        row.id = data.ids;//修改时以防和之前重名\r\n");
      out.write("\t\t                        cell.innerHTML =  '<img src=\\'");
      out.print(HeadConst.apache_url );
      out.write("/main/images/file1.gif\\'/> '+filename+'&nbsp;&nbsp;&nbsp;&nbsp;<img src=\\'");
      out.print(HeadConst.apache_url );
      out.write("/main/images/delete.gif\\' alt=\\'删除\\' title=\\'删除\\' onclick=\\'deleteUpdateFile(\"'+filename+'\",'+data.ids+');\\' style=\"cursor:point;\"/>';\r\n");
      out.write("                        ");

                        	}
                        
      out.write("\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("            },\r\n");
      out.write("            error: function (data, status, e)\r\n");
      out.write("            {\r\n");
      out.write("                alert(\"上传文件失败，请重新上传！\");\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("    )\r\n");
      out.write("}\r\n");
      out.write("function getInfo(){\r\n");
      out.write("\t//获取团队成员信息\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\treturn true;\r\n");
      out.write("}\r\n");
      out.write("function addItem(){\r\n");
      out.write("\r\n");
      out.write("openWindow(\"BaseUserCodeAction.jsp?values=\"+$(\"#SId\").val(),\"703,400\");\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("function setRole(pName,pId){\r\n");
      out.write("\t$(\"#teamtable\").append(pName);\r\n");
      out.write("\t$(\"#SId\").val(pId);\r\n");
      out.write("}\r\n");
      out.write("/*\r\n");
      out.write("上传文档格式过滤\r\n");
      out.write("*/\r\n");
      out.write("function checkFileType(){//上传文档格式过滤\r\n");
      out.write("\tvar file=document.getElementById('OtherAttach').value;\r\n");
      out.write("\tif(file){\r\n");
      out.write("\t\tvar allowType = {\"doc\":\"\", \"xls\":\"\", \"docx\":\"\", \"xlsx\":\"\"};\r\n");
      out.write("\t\tvar filename=file.replace(/.*(\\/|\\\\)/, \"\");//jquery获得文件名\r\n");
      out.write("\t\tvar fileExt=(/[.]/.exec(filename)) ? /[^.]+$/.exec(filename.toLowerCase()) : '';//jquery获得后缀名\r\n");
      out.write("\t\tif((fileExt+\"\").toLowerCase() in allowType){\r\n");
      out.write("\t\t\tuploadOtherAttatch();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\talert(\"上传文件格式不符合要求，请重新选择！\");\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\treturn false;\r\n");
      out.write("}\r\n");
      out.write("function deleteUpdateFile(name,id){//删除修改时上传附件\r\n");
      out.write("\tif(confirm('是否确定删除？')){\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\ttype:\"post\",\t\t\t\r\n");
      out.write("\t\t\turl:\"club-setup-addsave.jsp?cmd=delAttach&did=\"+id,\r\n");
      out.write("\t\t\tdataType:\"json\",\r\n");
      out.write("\t\t\tbeforeSend:function(){\r\n");
      out.write("\t\t\t\t$(\"#load1\").show();\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t\tsuccess:function(data, status, e){\r\n");
      out.write("\t        \tif(typeof(data.error) != 'undefined'){\r\n");
      out.write("                    if(data.error != '')\r\n");
      out.write("                    {\r\n");
      out.write("                        alert(data.error);\r\n");
      out.write("                    }else\r\n");
      out.write("                    {\r\n");
      out.write("                    \t$(\"#load1\").hide();\r\n");
      out.write("        \t\t\t\tvar row = document.getElementById(id);\r\n");
      out.write("        \t\t\t\tfor(var i=0;i<row.cells.length;i++){\r\n");
      out.write("        \t\t\t\t\trow.deleteCell(i);\r\n");
      out.write("        \t\t\t\t}\r\n");
      out.write("        \t\t\t\t\r\n");
      out.write("        \t\t\t\tvar files = document.form1.AddFileList.value;\r\n");
      out.write("        \t\t\t\t//alert(files+\" \"+id+\" \"+files.indexOf(id))\r\n");
      out.write("        \t\t\t\tif(files.indexOf(id)!=-1){\r\n");
      out.write("        \t\t\t\t\t//替换删掉的附件id\r\n");
      out.write("        \t\t\t\t\tfiles = \",\"+files+\",\";\r\n");
      out.write("        \t\t\t\t\tfiles = files.replace(\",\"+id+\",\",',');\r\n");
      out.write("        \t\t\t\t\t//没有附件的情况\r\n");
      out.write("        \t\t\t\t\tif(files.indexOf(\",\")==files.lastIndexOf(\",\"))\r\n");
      out.write("        \t\t\t\t\t\tfiles = \"\";\r\n");
      out.write("        \t\t\t\t\telse{\r\n");
      out.write("        \t\t\t\t\t\tfiles = files.substring(1,files.length-1);\r\n");
      out.write("        \t\t\t\t\t}\r\n");
      out.write("        \t\t\t\t\tdocument.form1.AddFileList.value = files;\r\n");
      out.write("        \t\t\t\t}\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("             },\r\n");
      out.write("            error: function (data, status, e){\r\n");
      out.write("            \t$(\"#load1\").hide();\r\n");
      out.write("                alert(\"删除文件失败!\");\r\n");
      out.write("            }\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\treturn false;\r\n");
      out.write("}\r\n");
      out.write("function deleteSponsor(trid,id){\r\n");
      out.write("\t$('#'+trid).remove();\r\n");
      out.write("\tvar files = document.form1.SId.value;\r\n");
      out.write("\t//alert(files+\" \"+id+\" \"+files.indexOf(id))\r\n");
      out.write("\tif(files.indexOf(id)!=-1){\r\n");
      out.write("\t\t//替换删掉的附件id\r\n");
      out.write("\t\tfiles = \",\"+files+\",\";\r\n");
      out.write("\t\tfiles = files.replace(\",\"+id+\",\",',');\r\n");
      out.write("\t\t//没有附件的情况\r\n");
      out.write("\t\tif(files.indexOf(\",\")==files.lastIndexOf(\",\"))\r\n");
      out.write("\t\t\tfiles = \"\";\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tfiles = files.substring(1,files.length-1);\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tdocument.form1.SId.value = files;\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<style type=\"text/css\" media=\"screen\">\r\n");
      out.write("\r\n");
      out.write(".oneitem {\r\n");
      out.write("\twidth:350px;\r\n");
      out.write("\tpadding:2px 6px 2px 6px;\r\n");
      out.write("\tbackground:#FFF;\r\n");
      out.write("}\r\n");
      out.write(".oneitem_out {\r\n");
      out.write("\twidth:350px;\r\n");
      out.write("\tbackground-color:#FFFFFF;\r\n");
      out.write("\tpadding:2px 6px 2px 6px;\r\n");
      out.write("}\r\n");
      out.write(".oneitem_over {\r\n");
      out.write("\twidth:350px;\r\n");
      out.write("\tbackground-color:#E8F2FE;\r\n");
      out.write("\tpadding:2px 6px 2px 6px;\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("<form name=\"form1\" method=\"post\" action=\"");
      out.print( url);
      out.write("\">\r\n");

List zhuguanoptions=CEditConst.getAcademyNameOptions(userinfo);
List shifouoptions=CEditConst.getYesNoOptions(userinfo);
String strposition = "志愿服务工作>>竞赛项目管理>>";
String strfunction = "竞赛项目申请信息";
String strhelpwords = "负责志愿竞赛项目的添加、修改、删除以及审核工作，点击竞赛项目名称的超链接可以进入相应的竞赛项目审核管理的界面。";

      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("\r\n");
      out.write("<table class=\"location-table\">\r\n");
      out.write("<tr height=\"35\">\r\n");
      out.write("\t<td class=\"location-title\" >您的位置：\r\n");
      out.write("\t\t<span style=\"cursor:pointer;\" onclick=\"showorhide_div('helpdiv')\"></span>\r\n");
      out.write("\t</td>\r\n");
      out.write("</tr>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("<div id=\"helpdiv\" style=\"display:none;\">\r\n");
      out.write("<table \tclass=\"location-help\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" >\r\n");
      out.write("<tr height=\"20\">\r\n");
      out.write("\t<td align=\"left\">系统帮助：</td>\r\n");
      out.write("   \t<td width=\"30\"> \r\n");
      out.write("\t\t<a align=\"right\" href=\"#\" onclick=\"showorhide_div('helpdiv')\"><font face='Webdings' color='#FF0000' style='font- size:32pt'>r</font></a>\r\n");
      out.write("\t</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr height=\"20\">\r\n");
      out.write("\t<td align=\"left\"></td>\r\n");
      out.write("</tr>\r\n");
      out.write("</table>\r\n");
      out.write("</div>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function showorhide_div(menu){\r\n");
      out.write("    $(\"#\"+menu).toggle();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("<table class=\"command-table\">\r\n");
      out.write("<tr>\r\n");
      out.write("      <td><a href=\"volunteer-project-list.jsp\" >返回</a></td>\r\n");
      out.write("</tr>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("<table class=\"tabs-table\">\r\n");
      out.write("<tr>\r\n");
      out.write("      <td id = \"base\"  class=\"");
      out.print(labelclass[0]);
      out.write("\"width=\"60\" align=\"center\" onclick=\"infoshow(1)\" >基本信息</td>\r\n");
      out.write("      <td id = \"team\" class=\"");
      out.print(labelclass[1]);
      out.write("\" width=\"60\" align=\"center\" onclick=\"infoshow(2)\" >人员信息</td>\r\n");
      out.write("      <td id = \"other\" class=\"");
      out.print(labelclass[2]);
      out.write("\" width=\"60\" align=\"center\" onclick=\"infoshow(3)\" >其他信息</td>\r\n");
      out.write("      <td id = \"file\"class=\"");
      out.print(labelclass[3]);
      out.write("\" width=\"60\" align=\"center\" onclick=\"infoshow(4)\" >文件上传</td>\r\n");
      out.write("</tr>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<table class=\"content-table\">\r\n");
      out.write("<tr>\r\n");
      out.write("\t<th colspan=\"5\" align=\"left\">竞赛项目申请信息</th>\r\n");
      out.write("</tr>\r\n");
      out.write("<tbody id=\"baseinfo\" style=\"display:block\">\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td width=\"15%\" align=\"right\">&nbsp;<font color=\"red\">*&nbsp;</font>项目名称：</td>\r\n");
      out.write("   \t\t<td width=\"50%\" align=\"left\"><input type=\"text\" name=\"ProjectName\"  maxlength=\"20\" size=\"50\" value=\"");
      out.print(projectname);
      out.write("\"></td>\r\n");
      out.write("   \t\t<td align=\"left\">请输入项目全称。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">*&nbsp;</font>团队名称：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"TeamName\"  maxlength=\"20\" size=\"50\" value=\"");
      out.print(teamname);
      out.write("\"></td>\r\n");
      out.write("   \t\t<td align=\"left\">请填写组织全称，已登记注册的以注册名称为准</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>团队主管单位：</td>\r\n");
      out.write("   \t\t<td align=\"left\">");
      out.print(HtmlTool.renderSelect(zhuguanoptions, "" + teamunit, "TeamUnit", "-1"));
      out.write("</td></td>\r\n");
      out.write("   \t\t<td align=\"left\">学院团委或者校级学生组织</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">*&nbsp;</font>登记证号：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"RegisterId\"  maxlength=\"20\" size=\"5\" value=\"");
      out.print(registerid);
      out.write("\">\r\n");
      out.write("   \t\t&nbsp;成立时间：\r\n");
      out.write("   \t\t\r\n");
      out.write("   \t\t<input readonly class=\"date\" onfocus=\"WdatePicker({dateFmt:'yyyy-MM-dd ',minDate:'%y-%M-%d %H:00:00',onpicked:function(){}})\"  name=\"SetupTime\" id=\"SetupTime\" size=\"0\" value=\"");
      out.print(setuptime);
      out.write("\">\r\n");
      out.write("   \t\t&nbsp;邮政编码：\r\n");
      out.write("   \t\t<input type=\"text\" name=\"ZipCode\"  maxlength=\"20\" size=\"10\" value=\"");
      out.print(zipcode);
      out.write("\">\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">登记证号如没有可填“无”</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">*&nbsp;</font>通讯地址：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"ContactAddress\"  maxlength=\"20\" size=\"50\" value=\"");
      out.print(contactaddress);
      out.write("\"></td>\r\n");
      out.write("   \t\t<td align=\"left\">通讯地址</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>年度年检结论：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"InspectionConclution\"  maxlength=\"20\" size=\"18\" value=\"");
      out.print(insepctionconclution);
      out.write("\">\r\n");
      out.write("   \t\t&nbsp;&nbsp;评估等级：\r\n");
      out.write("   \t\r\n");
      out.write("   \t\t");
      out.print(HtmlTool.renderSelect(AssLeveloptions, asslevel, "AssLevel", ""));
      out.write("\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">年检结论如没有，请填“无”，评估等级格式：xxxx年-评估等级（ABCD）</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>有无免税资格：</td>\r\n");
      out.write("   \t\t<td align=\"left\">");
      out.print(HtmlTool.renderSelect(shifouoptions, "" +dutyfree, "DutyFree", "-1"));
      out.write("\r\n");
      out.write("   \t\t&nbsp;&nbsp;&nbsp;项目实施时间：\r\n");
      out.write("   \t\t\r\n");
      out.write("   \t\t<input readonly class=\"date\" onfocus=\"WdatePicker({dateFmt:'yyyy-MM-dd ',minDate:'%y-%M-%d %H:00:00',onpicked:function(){}})\"  name=\"StartTime\" id=\"StartTime\" size=\"0\" value=\"");
      out.print(starttime);
      out.write("\">\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">免税资格填写：有/无</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>项目领域：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"ProjectArea\" maxlength=\"20\" size=\"18\" value=\"");
      out.print(projectarea);
      out.write("\">\r\n");
      out.write("   \t\t\t\r\n");
      out.write("   \t\t\r\n");
      out.write("<!-- \t\t\t\t\t\t\t<input type=\"radio\" name=\"projectarea\" value=\"阳光助残\">阳光助残&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"关爱农民工子女\">关爱农民工子女&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"邻里守望与为老服务\">邻里守望与为老服务&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"环境保护与节水护水\">环境保护与节水护水&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"扶贫开发与应急救援\">扶贫开发与应急救援&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"文化宣传与网络文明\">文化宣传与网络文明&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"禁毒教育与法律服务\">禁毒教育与法律服务&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"理论研究与基础建设\">理论研究与基础建设&nbsp;&nbsp;&nbsp;<br> -->\r\n");
      out.write("<!-- \t\t\t                 <input type=\"radio\" name=\"projectarea\" value=\"其它领域\">其它领域 -->\r\n");
      out.write("   \t\t<td align=\"left\">请填写项目明确参赛类别</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>实施地域：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"ImpleArea\"  maxlength=\"20\" size=\"50\" value=\"");
      out.print(implearea);
      out.write("\"></td>\r\n");
      out.write("   \t\t<td align=\"left\">具体到XX省XX市XX区</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>参与项目运作人数：</td>\r\n");
      out.write("   \t\t<td align=\"left\">\r\n");
      out.write("   \t\t\t<input type=\"text\" name=\"ParticipateNum\"  maxlength=\"20\" size=\"20\" value=\"");
      out.print(participatenum);
      out.write("\">\r\n");
      out.write("   \t\t\t&nbsp;&nbsp;&nbsp;专职人员人数：\r\n");
      out.write("   \t\t\t<input type=\"text\" name=\"FulltimeNum\"  maxlength=\"10\" size=\"13\" value=\"");
      out.print(fulltimenum);
      out.write("\">\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">请填写项目运作人数和专职人员人数</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>曾获何种奖励：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"Award\" rows=\"8\" cols=\"100\" >");
      out.print(award);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">填写校级以上荣誉</td>\r\n");
      out.write("</tr>\r\n");
      out.write("</tbody>\r\n");
      out.write("\r\n");
      out.write("<tbody id=\"teaminfo\" style=\"display:none\">\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td  width=\"25%\"align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>项目负责人：</td>\r\n");
      out.write("   \t\t<td align=\"left\">\r\n");
      out.write("   \t\t\t<p>姓名：<input type=\"text\" name=\"MajorName\"  value=\"");
      out.print(majorname);
      out.write("\"></p>\r\n");
      out.write("   \t\t\r\n");
      out.write("   \t\t    <p>工作单位及职务：<input type=\"text\" name=\"MajorDuty\"  value=\"");
      out.print(majorduty);
      out.write("\"></p>\r\n");
      out.write("   \t\t    <p>政治面貌：<input type=\"text\" name=\"MajorPolista\"  value=\"");
      out.print(majorpolista);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>办公电话：<input type=\"text\" name=\"MajorPhone\"   value=\"");
      out.print(majorphone);
      out.write("\"></p>\r\n");
      out.write(" \t\t\t<p>手机：<input type=\"text\" name=\"MajorPhone2\"   value=\"");
      out.print(majorphone2);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>电子邮箱：<input type=\"text\" name=\"MajorEmail\"  value=\"");
      out.print(majoremail);
      out.write("\"></p>\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">学生的工作单位及职务填写学院、年级、专业，办公电话为：区号+号码</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>项目指导教师：</td>\r\n");
      out.write("   \t\t<td align=\"left\">\r\n");
      out.write("   \t\t\t<p>姓名：<input type=\"text\" name=\"GuideTeacherName\" value=\"");
      out.print(guideteachername);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t\r\n");
      out.write("   \t\t\t<p>工作单位及职务：<input type=\"text\" name=\"GuideTeacherDuty\"  value=\"");
      out.print(guideteacherduty);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>政治面貌：<input type=\"text\" name=\"GuideTeacherPolista\" value=\"");
      out.print(guideteacherpolista);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>办公电话：<input type=\"text\" name=\"GuideTeacherPhone\"  value=\"");
      out.print(guideteacherphone);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>手机：<input type=\"text\" name=\"GuideTeacherPhone2\"  value=\"");
      out.print(guideteacherphone2);
      out.write("\"></p>\r\n");
      out.write("   \t\t\t<p>电子邮箱：<input type=\"text\" name=\"GuiderTeacherEmail\"  value=\"");
      out.print(guideteacheremail);
      out.write("\"></p>\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">办公电话为：区号+号码</td>\r\n");
      out.write("</tr>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<tr>\r\n");
      out.write("\t<td align=\"right\"><p>项目主要人员<p/><a href=\"#\" onclick=\"addItem();return false;\">添加</a></td>\r\n");
      out.write("\t<td align=\"left\" colspan=\"2\">\r\n");
      out.write("\t     <table class=\"content-table\" width=\"100%\" border=\"0\" cellspacing=\"0\" id=\"teamtable\">\r\n");
      out.write("        \t<tr><td>学号</td><td>姓名</td><td>院系</td><td>联系电话</td><td>职务</td><td></td></tr>\r\n");
      out.write("\t\t");

		String snoids="";
		if(vpp.getId()!=-1){
			VolunteerProjectTeammember vpt= new VolunteerProjectTeammember();
			List list2= new ArrayList();
			List cdt2= new ArrayList();
			List snoidlist= new ArrayList();
			List dutylist=new ArrayList();
			String vppid= vpp.getId()+"";
			cdt2.add("projectparticipateid="+vppid);
			cdt2.add("order by id ");
			list2= vpt.query(cdt2);
			
			if(list2.size()>0){
				for(int i=0;i<list2.size();i++){
					vpt=(VolunteerProjectTeammember)list2.get(i);
					snoidlist.add(vpt.getSno());
					 dutylist.add(vpt.getDuty());
				}
			}
		snoids=Tool.join(",", snoidlist);
		System.out.println(snoids+"sssssssssssssssssss");
			BaseUserCode stu= new BaseUserCode();
			List list3= new ArrayList();
			List cdt3= new ArrayList();
			cdt3.add("id in ("+snoids+")");
			String xueyuan="";
			String duty="";
			list3=stu.query(cdt3);
			if(list3.size()>0){
				for(int i=0;i<list3.size();i++){
				stu = (BaseUserCode)list3.get(i)	;
				 xueyuan=(String)CEditConst.getAcademyNameMap(userinfo).get(stu.getDeptId()+"");
				 duty=((String)dutylist.get(i)).equals("-1")?"":(String)dutylist.get(i);
				
      out.write("\r\n");
      out.write("\t\t\t\t<tr id='deleteSponsor_");
      out.print(stu.getId());
      out.write("'><td>");
      out.print(stu.getName() );
      out.write("</td><td>");
      out.print(stu.getCnName() );
      out.write("</td><td>");
      out.print(xueyuan );
      out.write("</td><td>");
      out.print(stu.getPhone() );
      out.write("</td><td><input size='10' name='zhiwu");
      out.print(i );
      out.write("' value=\"");
      out.print(duty );
      out.write("\" /></td><td><img style=\"cursor:point;\" src='");
      out.print(HeadConst.apache_url);
      out.write("/main/images/delete.gif' onclick=\"javascript:deleteSponsor('deleteSponsor_");
      out.print(stu.getId() );
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(stu.getId() );
      out.write("')\" alt='删除' title='删除' border=0 /></td></tr>\r\n");
      out.write("\t\t\t\t");
 
				}
			}
		}
		
		
      out.write("\t\r\n");
      out.write("\t\t\r\n");
      out.write("\r\n");
      out.write("\t\t</table>\r\n");
      out.write("           <input type=\"hidden\"  name=\"SId\" id=\"SId\" value=\"");
      out.print(snoids);
      out.write("\"/>\r\n");
      out.write("\t\t<input type=\"hidden\"  name=\"GuideTeacherBirth\" value=\"");
      out.print(guideteacherbirth);
      out.write("\"/>\r\n");
      out.write("\t</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr id=\"majorvolslist\" style=\"display:none\">\r\n");
      out.write("<td  align=\"right\">按学号查询：</td>\r\n");
      out.write("   <td width=\"40%\" align=\"left\">\r\n");
      out.write(" \r\n");
      out.write("      ");
      out.print(HtmlTool.renderSelect(UserCnNameoptions, "", "search2", ""));
      out.write("\r\n");
      out.write("      <a href=\"#\" onclick=\"searchadd2();return false;\">添加</a>\r\n");
      out.write("    <br>\r\n");
      out.write("\t<div id=\"searchdiv2\" style=\"z-index:99;\"></div>\r\n");
      out.write("    </td>\r\n");
      out.write("   <td align=\"left\">请输入学号或姓名然后点击添加按钮添加对应学生信息。</td>\r\n");
      out.write("</tr>\r\n");

//SELECT strSearchField FROM strSearchTable WHERE strSearchWhere AND 模糊匹配条件
String strSearchTable = "students";
//在strSearchField的多个字段同时实现对input的输入进行模糊查询，可有一个或多个查询条件
String strSearchField = "sno,sname,ssex";
//没有条件时写默认1=1，如果要查询的数据需要一定的限制时，在此写限制条件，该条件与输入框中的条件模糊查询
String strSearchWhere = "1=1"; 
//查询结果的展示，必须是strSearchField的子集构成
String strShow = "r.sno + '|'+ r.sname + '|'+ r.ssex";

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("<tbody id=\"otherinfo\" style=\"display:none\">\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td width=\"15%\" align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>项目内容：</td>\r\n");
      out.write("   \t\t<td width=\"50%\" align=\"left\"><textarea name=\"Content\" cols=\"100\" rows=\"4\">");
      out.print(content);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>项目背景意义：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"Meanings\" cols=\"100\" rows=\"4\">");
      out.print(meanings);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>预计效果：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"DisiredResults\" cols=\"100\" rows=\"4\">");
      out.print(disiredresults);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">受益群体、范围、人数，产生的社会效益等，100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>项目实施地点：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"ImplePlace\" cols=\"100\" rows=\"4\">");
      out.print(impleplace);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">精确到具体单位，100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>项目宣传方案：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"Promotion\" cols=\"100\" rows=\"4\">");
      out.print(promotion);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">创新性、示范性、可推广性，100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>项目特色：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><textarea name=\"Specialist\" cols=\"100\" rows=\"4\">");
      out.print(specialist);
      out.write("</textarea></td>\r\n");
      out.write("   \t\t<td align=\"left\">100字以内。</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\" >&nbsp;<font color=\"red\">*&nbsp;</font>受益对象：</td>\r\n");
      out.write("   \t\t<td align=\"left\"><input type=\"text\" name=\"BeneFicaiaries\"  maxlength=\"20\" size=\"50\" value=\"");
      out.print(beneficaiaries);
      out.write("\">\r\n");
      out.write("   \t\t&nbsp;&nbsp;&nbsp;预计直接受益人数：\r\n");
      out.write("   \t\t<input type=\"text\" name=\"Benenum\"  maxlength=\"10\" size=\"5\" value=\"");
      out.print(benenum);
      out.write("\">人\r\n");
      out.write("   \t\t</td>\r\n");
      out.write("   \t\t<td align=\"left\">请填写项目运作人数和专职人员人数</td>\r\n");
      out.write("</tr>\r\n");
      out.write("<tr>\r\n");
      out.write("   \t\t<td align=\"right\">&nbsp;<font color=\"red\">&nbsp;</font>学院团委、校级学生组织审批意见：</td>\r\n");
      out.write("   \t\t<td align=\"left\" >");
      out.print(checkcomments);
      out.write("</td>\r\n");
      out.write("   \t\t<td></td>\r\n");
      out.write("</tr>\r\n");
      out.write("</tbody>\r\n");
if(vpp.getProjectName()!=""){ 
      out.write("\r\n");
      out.write("\r\n");
      out.write("<input type=\"hidden\" name=\"Id\" value=\"");
      out.print(vpp.getId());
      out.write("\">\r\n");
} 
      out.write("\r\n");
      out.write("<input type=\"hidden\" name=\"CheckFlag\" value=\"\">\r\n");
      out.write("  <input type=\"hidden\" name=\"CheckFlag\" value=\"\">\r\n");
      out.write("    <input type=\"hidden\" name=\"Academy\" value=\"");
      out.print( user.getDeptId());
      out.write("\">\r\n");
      out.write("  <input type=\"hidden\" name=\"Sno\" value=\"");
      out.print(sno);
      out.write("\">\r\n");
      out.write("   <input type=\"hidden\" name=\"ProjectId\" value=\"");
      out.print(projectId);
      out.write("\">\r\n");
      out.write("  <input type=\"hidden\" name=\"page\" value=\"\">\r\n");
      out.write("  <input type=\"hidden\" name=\"teamcode\" value=\"");
      out.print(teamcode);
      out.write("\">\r\n");
      out.write("  <input type=\"hidden\"  name=\"AddFileList\" >\r\n");
      out.write("  <input type=\"hidden\" name=\"edittype\" value=\"");
      out.print(edittype);
      out.write("\">\r\n");
      out.write("  <input type=\"hidden\" name=\"teammemberslist\" value=\"\">\r\n");
      out.write("  <input type=\"hidden\" name=\"majorvolslist\" value=\"\">\r\n");
      out.write("</form>\r\n");
      out.write("<tbody id=\"fileinfo\" style=\"display:none\">\r\n");

String filepath = "/datafile/volunteer_project/";
String filenamecode = "";
String moduleapp = "../role-tuanwei/volunteer-project-list.jsp";
String mytip="";

      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t<tr height=\"35\"><td colspan=\"4\" class=\"blocktitle\">附件上传</td></tr>\r\n");
      out.write("\r\n");
      out.write("<input type=\"hidden\" name=\"Id\" id=\"Id\"value=\"");
      out.print(vpp.getId());
      out.write("\"/>\r\n");
      out.write("<tr id=\"postFormBookedBooths\">\r\n");
      out.write("\t<td class=\"form_label\"  width=\"14%\" >\r\n");
      out.write("\t<div align=\"right\">相关附件：</div>\r\n");
      out.write("\t</td>\r\n");
      out.write("\t\t<td bgcolor=\"#FFFFFF\" colspan=\"3\" align=\"left\">\r\n");
      out.write("\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" id=\"ShowFiles\">\r\n");
      out.write("\t\t\t");

				if(vpp.getId()!=-1){
					ClientAttach ca = new ClientAttach();
					//ca.setDataBase("sdtw");
					String ids = vpp.getAddFileList();
					if(ids!=null&&ids.trim().length()>0){
						String[] idArray = Tool.split(",",ids);
						for(int i=0;i<idArray.length;i++){
							ClientAttach ca1 = ca.getById(Tool.StrToInt(idArray[i]));
							if(ca1!=null){
								
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<tr id=\"");
      out.print(ca1.getId() );
      out.write("\"><td><a href=\"");
      out.print(HeadConst.apache_url );
      out.write("/servlet/attach?type=otherattach&id=");
      out.print(ca1.getId() );
      out.write("\" target=\"_blank\">\r\n");
      out.write("\t\t\t\t\t\t\t\t<img src='");
      out.print(HeadConst.apache_url);
      out.write("/main/images/file1.gif' border=\"0\"/> ");
      out.print(ca1.getUploadName() );
      out.write("</a>&nbsp;&nbsp;&nbsp;&nbsp;\r\n");
      out.write("\t\t\t\t\t\t\t\t<img src='");
      out.print(HeadConst.apache_url);
      out.write("/main/images/delete.gif' alt='删除' title='删除' border=\"0\" onclick=\"javascript:deleteUpdateFile('");
      out.print(ca1.getUploadName());
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(ca1.getId() );
      out.write("')\" style=\"cursor:point;\"/></td></tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t");
	}
								}
							}
						}
					
      out.write("\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<input type=\"file\" name=\"OtherAttach\" id=\"OtherAttach\" size=\"40\"/> \r\n");
      out.write("\t\t<input type=\"button\" value=\"上传\" id=\"btn_up\"  onclick=\"checkFileType();\" class=\"formbtn\" style=\"color:black;background-color: #e3e5e8;\"/>\r\n");
      out.write("\t\r\n");
      out.write("\t\t<img style=\"display:none\" id=\"load1\" src=\"");
      out.print(HeadConst.apache_url);
      out.write("/main/images/loading.gif\"/>\r\n");
      out.write("\t    <div style=\"color:red\">请上传doc、docx、xlsx或xls格式文件，文件最大1M</div>\r\n");
      out.write("\t</td>\r\n");
      out.write("</tr>\r\n");
      out.write("</tbody>\r\n");
      out.write("<tr>\r\n");
      out.write("  <th colspan=\"6\" align=\"center\">\r\n");
      out.write("    <input type=\"button\" value=\"保存\" name=\"btn1\" onclick=\"form1submit()\" class=\"button\">&nbsp;&nbsp;&nbsp;\r\n");
      out.write("    <input type=\"button\" value=\"取消\" name=\"btn2\" onclick=\"form99cancel()\" class=\"button\">&nbsp;&nbsp;&nbsp;\r\n");
      out.write("  </th>\r\n");
      out.write("</tr>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\r\n");
      out.write("function infoshow(val)\r\n");
      out.write("{\r\n");
      out.write("\tswitch(val)\r\n");
      out.write("\t{\r\n");
      out.write("\t\tcase 1:\r\n");
      out.write("\t\t\t$(\"#baseinfo\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t\t$(\"#teaminfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#otherinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#fileinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#base\").attr(\"class\",\"labelon\");\r\n");
      out.write("\t\t\t$(\"#team\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#other\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#file\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 2:\r\n");
      out.write("\t\t\t$(\"#baseinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#teaminfo\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t\t$(\"#otherinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#fileinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#base\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#team\").attr(\"class\",\"labelon\");\r\n");
      out.write("\t\t\t$(\"#other\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#file\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 3:\r\n");
      out.write("\t\t\t$(\"#baseinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#teaminfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#otherinfo\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t\t$(\"#fileinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#base\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#team\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#other\").attr(\"class\",\"labelon\");\r\n");
      out.write("\t\t\t$(\"#file\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tdefault:\r\n");
      out.write("\t\t\t$(\"#baseinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#teaminfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#otherinfo\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t\t$(\"#fileinfo\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t\t$(\"#base\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#team\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#other\").attr(\"class\",\"labeloff\");\r\n");
      out.write("\t\t\t$(\"#file\").attr(\"class\",\"labelon\");\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("/////////////////////////////////////////////////////////////////////////////////////////////\r\n");
      out.write("///////////////////以下代码是添加项目主要人员和添加项目志愿者的公共函数和代码\r\n");
      out.write("\r\n");
      out.write("$(function(){\r\n");
      out.write("\t$(\"#datepicker\").datepicker();\r\n");
      out.write("\t$(\"#datepicker2\").datepicker();\r\n");
      out.write("\tshowinfo();\r\n");
      out.write("});\r\n");
      out.write("///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n");
      out.write("///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n");
      out.write("function form1submit()\r\n");
      out.write("{\r\n");
      out.write("  // 取form1表单数据,到form99隐藏框\r\n");
      out.write("/*   if(!form1datacheck())\r\n");
      out.write("  {\r\n");
      out.write("    return false;\r\n");
      out.write("  } */\r\n");
      out.write("\r\n");
      out.write("  var check=");
      out.print(vpp.getXycheckFalg());
      out.write(";\r\n");
      out.write(" var twcheck=");
      out.print(vpp.getCheckFlag());
      out.write("\r\n");
      out.write("  if(check==1&&twcheck==1){\r\n");
      out.write("\t  alert(\"正在审核中，无法修改\")\r\n");
      out.write("\t  return;\r\n");
      out.write("  }\r\n");
      out.write(" if( form1datacheck()){\r\n");
      out.write("  document.form1.submit();\r\n");
      out.write(" }\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function form1datacheck()\r\n");
      out.write("{   \r\n");
      out.write("\tgetInfo();\r\n");
      out.write("\tif (document.form1.ProjectName.value==\"\"){\r\n");
      out.write("\t\talert(\"项目名称不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ProjectName.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.TeamName.value==\"\"){\r\n");
      out.write("\t\talert(\"团队名称不能为空！\");\r\n");
      out.write("\t\tdocument.form1.TeamName.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.TeamUnit.value==\"\"){\r\n");
      out.write("\t\talert(\"团队主管单位不能为空！\");\r\n");
      out.write("\t\tdocument.form1.TeamUnit.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.RegisterId.value==\"\"){\r\n");
      out.write("\t\talert(\"登记证号不能为空！\");\r\n");
      out.write("\t\tdocument.form1.RegisterId.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.SetupTime.value==\"\"){\r\n");
      out.write("\t\talert(\"成立时间不能为空！\");\r\n");
      out.write("\t\tdocument.form1.SetupTime.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ZipCode.value==\"\"){\r\n");
      out.write("\t\talert(\"邮政编码不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ZipCode.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ContactAddress.value==\"\"){\r\n");
      out.write("\t\talert(\"通讯地址不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ContactAddress.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.InspectionConclution.value==\"\"){\r\n");
      out.write("\t\talert(\"年度年检结论不能为空！\");\r\n");
      out.write("\t\tdocument.form1.InspectionConclution.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.AssLevel.value==\"\"){\r\n");
      out.write("\t\talert(\"评估等级不能为空！\");\r\n");
      out.write("\t\tdocument.form1.AssLevel.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.DutyFree.value==\"\"){\r\n");
      out.write("\t\talert(\"有无免税资格不能为空！\");\r\n");
      out.write("\t\tdocument.form1.DutyFree.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.StartTime.value==\"\"){\r\n");
      out.write("\t\talert(\"项目实施时间不能为空！\");\r\n");
      out.write("\t\tdocument.form1.StartTime.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ProjectArea.value==\"\"){\r\n");
      out.write("\t\talert(\"项目领域不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ProjectArea.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ImpleArea.value==\"\"){\r\n");
      out.write("\t\talert(\"实施地域不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ImpleArea.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ParticipateNum.value==\"\"){\r\n");
      out.write("\t\talert(\"参与项目运作人数不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ParticipateNum.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.MajorNamevalue==\"\"){\r\n");
      out.write("\t\talert(\"项目负责人姓名不能为空！\");\r\n");
      out.write("\t\tdocument.form1.MajorName.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tif (document.form1.MajorDuty.value==\"\"){\r\n");
      out.write("\t\talert(\"项目负责人职务不能为空！\");\r\n");
      out.write("\t\tdocument.form1.MajorDuty.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tif (document.form1.MajorPhone2.value==\"\"){\r\n");
      out.write("\t\talert(\"项目负责人手机不能为空！\");\r\n");
      out.write("\t\tdocument.form1.MajorPhone2.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.MajorEmail.value==\"\"){\r\n");
      out.write("\t\talert(\"项目负责人邮箱不能为空！\");\r\n");
      out.write("\t\tdocument.form1.MajorEmail.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.GuideTeacherName.value==\"\"){\r\n");
      out.write("\t\talert(\"项目指导教师姓名不能为空！\");\r\n");
      out.write("\t\tdocument.form1.GuideTeacherName.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tif (document.form1.GuideTeacherDuty.value==\"\"){\r\n");
      out.write("\t\talert(\"项目指导教师职务不能为空！\");\r\n");
      out.write("\t\tdocument.form1.GuideTeacherDuty.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tif (document.form1.GuideTeacherPhone2.value==\"\"){\r\n");
      out.write("\t\talert(\"项目指导教师手机不能为空！\");\r\n");
      out.write("\t\tdocument.form1.GuideTeacherPhone2.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.GuiderTeacherEmail.value==\"\"){\r\n");
      out.write("\t\talert(\"项目指导教师邮箱不能为空！\");\r\n");
      out.write("\t\tdocument.form1.GuiderTeacherEmail.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.Content.value==\"\"){\r\n");
      out.write("\t\talert(\"项目内容不能为空！\");\r\n");
      out.write("\t\tdocument.form1.Content.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.Meanings.value==\"\"){\r\n");
      out.write("\t\talert(\"项目背景意义不能为空！\");\r\n");
      out.write("\t\tdocument.form1.Manings.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.DisiredResults.value==\"\"){\r\n");
      out.write("\t\talert(\"预计效果不能为空！\");\r\n");
      out.write("\t\tdocument.form1.DisiredResults.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.ImplePlace.value==\"\"){\r\n");
      out.write("\t\talert(\"项目实施地点不能为空！\");\r\n");
      out.write("\t\tdocument.form1.ImplePlace.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.Promotion.value==\"\"){\r\n");
      out.write("\t\talert(\"项目宣传方案不能为空！\");\r\n");
      out.write("\t\tdocument.form1.Promotion.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.Specialist.value==\"\"){\r\n");
      out.write("\t\talert(\"项目特色不能为空！\");\r\n");
      out.write("\t\tdocument.form1.Specialist.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.BeneFicaiaries.value==\"\"){\r\n");
      out.write("\t\talert(\"受益对象不能为空！\");\r\n");
      out.write("\t\tdocument.form1.BeneFicaiaries.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("\tif (document.form1.Benenum.value==\"\"){\r\n");
      out.write("\t\talert(\"预计直接收益人数不能为空！\");\r\n");
      out.write("\t\tdocument.form1.Benenum.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t}\r\n");
      out.write("    return true;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function showinfo()\r\n");
      out.write("{\r\n");
      out.write("\tvar teammemberslist = \"");
      out.print(teammemberslist);
      out.write("\";\r\n");
      out.write("\tvar majorvolslist = \"");
      out.print(majorvolslist);
      out.write("\";\r\n");
      out.write("\tdocument.form1.teammemberslist.value = teammemberslist;\r\n");
      out.write("\tdocument.form1.majorvolslist.value = majorvolslist;\r\n");
      out.write("\tvar radiolen = $(\"[name='projectarea']\").length;\r\n");
      out.write("\r\n");
      out.write("\tif(teammemberslist!=\"\")\r\n");
      out.write("\t{\r\n");
      out.write("\t\tvar team_array = teammemberslist.split(\"\\20\");\r\n");
      out.write("\t\t$(\"#teammemberslist\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t$(\"#teammembersadd\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t$(\"#teammemberscancel\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\tvar showstr = $(\"#teammembersshow\").html();\r\n");
      out.write("\t\tfor(var i=0;i<team_array.length-1;i++)\r\n");
      out.write("\t\t{\r\n");
      out.write("\t\t\tvar teaminfo_array = team_array[i].split(\"\\10\");\r\n");
      out.write("\t\t\tshowstr += teaminfo_array[1] + \"  \" + teaminfo_array[2] + \"  \" + teaminfo_array[3] + \"  \" + teaminfo_array[4] + \"  \" + teaminfo_array[5] + \"  \" + teaminfo_array[6] + \"&nbsp;&nbsp;<a href='#' onclick='teammembersdel(\\\"\"+teaminfo_array[0]+\"\\\")'>删除</a><br>\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t$(\"#teammembersshow\").html(showstr);\r\n");
      out.write("\t}\r\n");
      out.write("\tif(majorvolslist!=\"\")\r\n");
      out.write("\t{\r\n");
      out.write("\t\tvar vol_array = majorvolslist.split(\"\\20\");\r\n");
      out.write("\t\t$(\"#majorvolslist\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\t$(\"#majorvolsadd\").attr(\"style\",\"display:none\");\r\n");
      out.write("\t\t$(\"#majorvolscancel\").attr(\"style\",\"display:block\");\r\n");
      out.write("\t\tvar showstr = $(\"#majorvolsshow\").html();\r\n");
      out.write("\t\tfor(var i=0;i<vol_array.length-1;i++)\r\n");
      out.write("\t\t{\r\n");
      out.write("\t\t\tvar volinfo_array = vol_array[i].split(\"\\10\");\r\n");
      out.write("\t\t\tshowstr += volinfo_array[0] + \"  \" + volinfo_array[1] + \"&nbsp;&nbsp;<a href='#' onclick='majorvolsdel(\\\"\"+volinfo_array[0]+\"\\\")'>删除</a>&nbsp;&nbsp;&nbsp;\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t$(\"#majorvolsshow\").html(showstr);\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("</script>\r\n");
      out.write("</form>\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
